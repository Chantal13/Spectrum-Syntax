<div class="book-card">
  <a class="book-card__cover" href="{{ include.book.link }}">
    {% assign cover_l = include.book.image.large %}
    {% assign cover_m = include.book.image.medium %}
    {% assign cover_s = include.book.image.small %}
    {% assign cover = cover_l | default: cover_m | default: cover_s %}
    {% assign cache_bust = site.time | date: '%s' %}
    {%- comment -%} Append cache-busting query param to cover URLs {%- endcomment -%}
    {% if cover %}
      {% assign sep = '?' %}{% if cover contains '?' %}{% assign sep = '&' %}{% endif %}
      {% assign cover_v = cover | append: sep | append: 'v=' | append: cache_bust %}
    {% endif %}
    {% if cover_s %}
      {% assign sep = '?' %}{% if cover_s contains '?' %}{% assign sep = '&' %}{% endif %}
      {% assign cover_s_v = cover_s | append: sep | append: 'v=' | append: cache_bust %}
    {% endif %}
    {% if cover_m %}
      {% assign sep = '?' %}{% if cover_m contains '?' %}{% assign sep = '&' %}{% endif %}
      {% assign cover_m_v = cover_m | append: sep | append: 'v=' | append: cache_bust %}
    {% endif %}
    {% if cover_l %}
      {% assign sep = '?' %}{% if cover_l contains '?' %}{% assign sep = '&' %}{% endif %}
      {% assign cover_l_v = cover_l | append: sep | append: 'v=' | append: cache_bust %}
    {% endif %}
    {% if cover %}
      <img 
        src="{{ cover_v | default: cover }}"
        {% if cover_s or cover_m or cover_l %}
        srcset="{% if cover_s %}{{ cover_s_v | default: cover_s }} 50w{% endif %}{% if cover_m %}{% if cover_s %}, {% endif %}{{ cover_m_v | default: cover_m }} 98w{% endif %}{% if cover_l %}{% if cover_s or cover_m %}, {% endif %}{{ cover_l_v | default: cover_l }} 318w{% endif %}"
        sizes="(min-width: 900px) 360px, (min-width: 700px) 320px, 90vw"
        {% endif %}
        loading="lazy" decoding="async"
        alt="Cover of {{ include.book.title | escape }}">
    {% else %}
      <div class="book-card__no-cover">No cover</div>
    {% endif %}
  </a>
  <div class="book-card__body">
    <h3 class="book-card__title">
      <a href="{{ include.book.link }}">{{ include.book.title }}</a>
    </h3>
    {% if include.book.author %}
      <p class="book-card__byline">{{ include.book.author }}</p>
    {% endif %}
    <div class="book-card__meta">
      {% if include.book.my_rating %}
        <span class="rating" title="My rating">⭐ {{ include.book.my_rating }}/5</span>
      {% endif %}
      {% if include.book.average_rating %}
        <span class="rating avg" title="Average rating">★ {{ include.book.average_rating | round: 2 }}/5</span>
      {% endif %}
    </div>
    {% assign desc = include.book.description_html | strip_html | replace: "&nbsp;", " " | replace: "&#39;", "'" %}
    {% assign words = include.excerpt_words | default: 45 %}
    {% if desc and desc != '' %}
      <p class="book-card__desc">{{ desc | truncatewords: words }}</p>
    {% endif %}
  </div>
  
</div>
