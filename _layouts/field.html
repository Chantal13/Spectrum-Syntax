---
layout: default
---

<h1>{{ page.title }}</h1>
{%- comment -%}
  Choose a primary image for the entry. Prefer explicit `thumbnail`,
  then `images.close_up`, then `images.scale`.
{%- endcomment -%}
{% assign primary_img = nil %}
{% if page.thumbnail %}
  {% assign primary_img = page.thumbnail %}
{% elsif page.images and page.images.close_up %}
  {% assign primary_img = page.images.close_up %}
{% elsif page.images and page.images.scale %}
  {% assign primary_img = page.images.scale %}
{% endif %}

<div class="field-summary field-card">
  {% if primary_img %}
    {% assign cache_bust = site.time | date: '%s' %}
    {% assign tn = primary_img %}
    <div class="field-cover">
    {% if tn contains '://' %}
      {% assign sep = '?' %}{% if tn contains '?' %}{% assign sep = '&' %}{% endif %}
      {% assign tn_url = tn | append: sep | append: 'v=' | append: cache_bust %}
      <img src="{{ tn_url }}" alt="{{ page.title }}">
    {% else %}
      {% assign tn_url = tn | relative_url %}
      {% assign tn_url = tn_url | append: '?v=' | append: cache_bust %}
      {% assign tn_webp_candidate = tn | replace: '.jpg', '.webp' | replace: '.jpeg', '.webp' | replace: '.png', '.webp' %}
      {% assign tn_webp_path = tn_webp_candidate | image_exists %}
      {% if tn_webp_path %}
        {% assign tn_webp_url = tn_webp_path | relative_url %}
        {% assign tn_webp_url = tn_webp_url | append: '?v=' | append: cache_bust %}
        <picture>
          <source srcset="{{ tn_webp_url }}" type="image/webp">
          <img src="{{ tn_url | uri_escape }}" alt="{{ page.title }}">
        </picture>
      {% else %}
        <img src="{{ tn_url | uri_escape }}" alt="{{ page.title }}">
      {% endif %}
    {% endif %}
    </div>
  {% endif %}

  <ul class="field-details">
    {% if page.date %}
    <li><strong>Date:</strong> {{ page.date | date: '%Y-%m-%d' }}</li>
    {% endif %}

    {%- assign loc = page.location -%}
    {% if loc %}
    {% if loc.lat or loc.lng or loc.description %}
    <li>
      <strong>Location:</strong>
      {% if loc.description %}{{ loc.description }}{% endif %}
      {% if loc.lat and loc.lng %}
        <div class="loc-coords">
          <code>{{ loc.lat }}, {{ loc.lng }}</code>
          · <a class="map-link" href="https://www.openstreetmap.org/?mlat={{ loc.lat }}&mlon={{ loc.lng }}#map=16/{{ loc.lat }}/{{ loc.lng }}">
            <svg class="map-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M12 21s-6-5.7-6-10a6 6 0 0 1 12 0c0 4.3-6 10-6 10z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="12" cy="11" r="2" fill="currentColor"/>
            </svg>
            <span class="label">OSM</span>
          </a>
          · <a class="map-link" href="https://maps.google.com/?q={{ loc.lat }},{{ loc.lng }}">
            <svg class="map-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M12 21s-6-5.7-6-10a6 6 0 0 1 12 0c0 4.3-6 10-6 10z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="12" cy="11" r="2" fill="currentColor"/>
            </svg>
            <span class="label">Google</span>
          </a>
        </div>
      {% endif %}
    </li>
    {% endif %}
    {% endif %}

    {% if page.rocks %}
    <li><strong>Rock type:</strong>
      <span class="chips">
        {% for r in page.rocks %}
          <span class="chip chip--{{ r | slugify }}">{{ r }}</span>
        {% endfor %}
      </span>
    </li>
    {% endif %}
    {% if page.minerals %}
    <li><strong>Minerals:</strong>
      <span class="chips">
        {% for m in page.minerals %}
          <span class="chip chip--{{ m | slugify }}">{{ m }}</span>
        {% endfor %}
      </span>
    </li>
    {% endif %}

    {% assign colour = page.colour | default: page.color %}
    {% if colour %}
    <li><strong>Colour:</strong> {{ colour }}</li>
    {% endif %}

    {% if page.lustre %}
    <li><strong>Lustre:</strong> {{ page.lustre }}</li>
    {% endif %}

    {% if page.hardness_mohs or page.hardness %}
    <li><strong>Hardness (Mohs):</strong> {{ page.hardness_mohs | default: page.hardness }}</li>
    {% endif %}

    {% if page.streak %}
    <li><strong>Streak:</strong> {{ page.streak }}</li>
    {% endif %}

    {% if page.crystal_form_texture %}
    <li><strong>Crystal form/Texture:</strong> {{ page.crystal_form_texture }}</li>
    {% endif %}

    {% if page.cleavage or page.fracture %}
    <li><strong>Cleavage/Fracture:</strong>
      {%- if page.cleavage %} Cleavage: {{ page.cleavage }}{%- endif -%}
      {%- if page.cleavage and page.fracture %} · {% endif -%}
      {%- if page.fracture %} Fracture: {{ page.fracture }}{%- endif -%}
    </li>
    {% endif %}
  </ul>
</div>

{%- if page.images -%}
{%- if page.images.close_up or page.images.scale -%}
  <section class="field-card">
  <h2>Photos</h2>
  <div class="field-photos">
    {%- if page.images.close_up -%}
      {% assign cu = page.images.close_up %}
      <figure>
        <img src="{{ cu | relative_url }}" alt="Close-up photo">
        <figcaption>Close-up</figcaption>
      </figure>
    {%- endif -%}
    {%- if page.images.scale -%}
      {% assign sc = page.images.scale %}
      <figure>
        <img src="{{ sc | relative_url }}" alt="Scale photo">
        <figcaption>With scale</figcaption>
      </figure>
    {%- endif -%}
  </div>
  </section>
{%- endif -%}
{%- endif -%}

<section class="field-card field-notes">
  {{ content }}
</section>

{%- if page.gallery and page.gallery.size > 0 -%}
  <section class="field-card">
  <h2>Gallery</h2>
  <div class="field-gallery">
    {%- for g in page.gallery -%}
      {%- assign src = g.src | default: g['src'] -%}
      {%- if src -%}
      <figure>
        <img src="{{ src | relative_url }}" alt="{{ g.caption | default: 'Specimen photo' }}">
        {%- if g.caption -%}<figcaption>{{ g.caption }}</figcaption>{%- endif -%}
      </figure>
      {%- endif -%}
    {%- endfor -%}
  </div>
  </section>
{%- endif -%}
